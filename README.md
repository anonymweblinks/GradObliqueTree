# Gradient-based Oblique Regression Tree
Draft version for reviewing only, all rights reserved. Will be updated and open-sourced after the paper is published.



<div align="center">

![Language](https://img.shields.io/badge/language-Python-blue?&logo=python)
![Dependencies Status](https://img.shields.io/badge/dependencies-PyTorch-brightgreen.svg)
[![License](https://img.shields.io/github/license/maoqiangqiang/decisiontreebaseline)](https://github.com/maoqiangqiang/DecisionTreeBaseline/blob/main/LICENSE)



</div>

## Requirements
- PyTorch 1.11.0+cu113
- Python 3.9.6
    - scikit-learn 1.0.2
    - numpy 1.21.6
    - pandas 1.3.5
    - h5py 3.8.0


## Script Description 
- `src` folder contains the scripts of gradient-based oblique regression tree. 
  - `ancestorTF_File` subfolder contains the deterministic tree path routing (simply tree path of sample assignment) in h5 file format. These files can be generated by the function of `treePathCalculation` in `treeFunc.py` script. 
  - `treeFunc.py` includes utility functions. 
  - `dataset.py` is to load the dataset. 
  - `warmStart.py` generates the warm-start initialization based on `CART` method.
  - `GWTFunc.py` includes the main functions of `GWT` method. 
  - `GPSubFunc.py` includes the main functions of `GPSub` method. 

- `test` folder contains the script of running these algorithms.
  - `test_GWT.py` is to test the `GWT` method.
  - `test_GWTGPSub.py` is to test the `GPSub` method. 
- `data` folder contains the datasets. These publicly-available datasets are from the UCI Machine Learning repository. Each dataset is shuffled and split into training, validation and testing sets, and saved in the *csv format.
## Examples 
The examples can be implemented via:
```Shell 
# test the GWT method 
Python test/test_GWT.py 4 4 1 1 2 5000 "cuda" 1
# test the GPSub method
Python test/test_GWTGPSub.py 4 4 1 1 2 5000 "cuda" 1
```




## License
This repository is published under the terms of the `MIT License`. 
